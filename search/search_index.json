{"config":{"lang":["fr"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"index.html","title":"Cours de Florent Foug\u00e8res","text":""},{"location":"index.html#table-des-matieres","title":"\ud83d\udcda Table des mati\u00e8res","text":""},{"location":"index.html#traitement-de-donnees-geospatiales-duckdb","title":"Traitement de donn\u00e9es g\u00e9ospatiales DuckDB","text":"<ul> <li>Pr\u00e9sentation (markdown)</li> <li>Pr\u00e9sentation (PDF)</li> <li>Exercice</li> </ul>"},{"location":"duckdb/exercice.html","title":"Traitement de donn\u00e9es g\u00e9ospatiales DuckDB","text":""},{"location":"duckdb/exercice.html#la-presentation","title":"La pr\u00e9sentation","text":""},{"location":"duckdb/exercice.html#exercice-1-introduction-avec-la-cli-duckdb","title":"Exercice 1 : Introduction avec la CLI DuckDB","text":""},{"location":"duckdb/exercice.html#telecharger-lexecutable-duckdb","title":"T\u00e9l\u00e9charger l'ex\u00e9cutable DuckDB","text":"<p>Depuis le site officiel</p> <p></p>"},{"location":"duckdb/exercice.html#lancer-duckdb-depuis-un-terminal","title":"Lancer DuckDB depuis un terminal","text":"<p>Il faut, depuis un terminal, se placer dans le dossier o\u00f9 vous avez t\u00e9l\u00e9charg\u00e9 l'ex\u00e9cutable, par exemple :</p> <pre><code>cd C:\\Users\\florent\\\n</code></pre> <p>Puis lancer l'ex\u00e9cutable :</p> <pre><code>duckdb.exe\n</code></pre> <p>On arrive alors dans la console DuckDB (\u00e9quivalent de psql) o\u00f9 l'on peut taper du SQL.</p> <pre><code>SELECT 1 as number, 'a' as letter ; \n</code></pre> <p>Info</p> <p>Avant d'appuyer sur Entr\u00e9e, il faut toujours terminer l'instruction SQL par un point-virgule <code>;</code></p>"},{"location":"duckdb/exercice.html#installer-lextension-spatial","title":"Installer l'extension spatial","text":"<pre><code>INSTALL spatial; \n</code></pre> <p>Puis charger l'extension :</p> <pre><code>LOAD spatial;\n</code></pre> <p>La documentation de l'extension spatial se trouve sur cette page, on y retrouve la liste des fonctions disponibles.</p>"},{"location":"duckdb/exercice.html#creer-une-base-de-donnees","title":"Cr\u00e9er une base de donn\u00e9es","text":"<p>Warning</p> <p>Actuellement nous sommes dans une base temporaire, tout ce que nous ex\u00e9cutons ne sera pas sauvegard\u00e9. Il faut donc cr\u00e9er une base de donn\u00e9es pour conserver notre travail.</p> <pre><code>.open C:\\Users\\florent\\chemin\\vers\\ma\\base.duckdb\n</code></pre>"},{"location":"duckdb/exercice.html#creer-une-table","title":"Cr\u00e9er une table","text":"<p>Cette page de la documentation montre des exemples.</p> <p>On va cr\u00e9er une table nomm\u00e9e <code>ville</code> avec plusieurs champs : <code>id</code> sera notre cl\u00e9 primaire et s'auto-incr\u00e9mentera, <code>nom</code> sera de type <code>VARCHAR</code> et <code>geom</code> sera un champ g\u00e9om\u00e9trique.</p> <p>Warning</p> <p>Attention, les colonnes de g\u00e9om\u00e9trie n'ont pas de type. Une des particularit\u00e9s des colonnes de g\u00e9om\u00e9trie dans DuckDB spatial est l'absence de d\u00e9finition du type de g\u00e9om\u00e9trie (contrairement \u00e0 PostGIS par exemple). Une m\u00eame colonne de g\u00e9om\u00e9trie peut contenir aussi bien des points, des lignes, des polygones, etc. Il est donc possible de m\u00e9langer des points et des lignes dans une m\u00eame table, mais m\u00eame si c'est techniquement possible, je vous le d\u00e9conseille.</p> <pre><code>CREATE SEQUENCE seq_ville START 1;\nCREATE TABLE ville (\n    id   INTEGER DEFAULT nextval('seq_ville') PRIMARY KEY,\n    nom  VARCHAR,\n    geom GEOMETRY\n);\n</code></pre> <p>Info</p> <p>Pour rappel, une colonne de g\u00e9om\u00e9trie n'a pas de syst\u00e8me de projection dans sa d\u00e9finition. En cons\u00e9quence, il n'y a : - pas de d\u00e9finition de projection comme contrainte pour une colonne - pas d'attribution d'une projection lors d'un export</p> <p>La commande <code>DESCRIBE</code> permet d'obtenir la description de la structure d'une table.</p> <pre><code>D describe ville ; \n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 column_name \u2502 column_type \u2502  null   \u2502   key   \u2502 default \u2502  extra  \u2502\n\u2502   varchar   \u2502   varchar   \u2502 varchar \u2502 varchar \u2502 varchar \u2502 varchar \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 id          \u2502 INTEGER     \u2502 NO      \u2502 PRI     \u2502 NULL    \u2502 NULL    \u2502\n\u2502 nom         \u2502 VARCHAR     \u2502 YES     \u2502 NULL    \u2502 NULL    \u2502 NULL    \u2502\n\u2502 geom        \u2502 GEOMETRY    \u2502 YES     \u2502 NULL    \u2502 NULL    \u2502 NULL    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre> <p>La commande <code>SHOW TABLES</code> permet de lister les tables.</p> <pre><code>D SHOW TABLES ; \n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  name   \u2502\n\u2502 varchar \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 ville   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre> <p>On va maintenant ins\u00e9rer des donn\u00e9es dans notre table.</p> <pre><code>INSERT INTO ville (nom, geom) VALUES\n    ('Rennes',    ST_GeomFromText('POINT(-1.6778 48.1173)')),\n    ('Marseille', ST_GeomFromText('POINT(5.3698 43.2965)')),\n    ('Laval',     ST_GeomFromText('POINT(-0.7667 48.0667)'));\n</code></pre> <p>Regardons le r\u00e9sultat.</p> <pre><code>D select * from ville ; \n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  id   \u2502    nom    \u2502          geom           \u2502\n\u2502 int32 \u2502  varchar  \u2502        geometry         \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502     1 \u2502 Rennes    \u2502 POINT (-1.6778 48.1173) \u2502\n\u2502     2 \u2502 Marseille \u2502 POINT (5.3698 43.2965)  \u2502\n\u2502     3 \u2502 Laval     \u2502 POINT (-0.7667 48.0667) \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"duckdb/exercice.html#importer-un-csv-et-creer-la-geometrie","title":"Importer un CSV et cr\u00e9er la g\u00e9om\u00e9trie","text":"<p>Info</p> <p>La fonction <code>read_csv_auto</code> nous permet d'importer un CSV sans avoir \u00e0 cr\u00e9er la table au pr\u00e9alable. Cette fonction d\u00e9tecte automatiquement la structure du CSV.</p> <pre><code>CREATE TABLE airports AS FROM read_csv_auto('https://davidmegginson.github.io/ourairports-data/airports.csv', HEADER=True, DELIM=',') ;\n</code></pre> <p>Il faut maintenant ajouter une colonne de g\u00e9om\u00e9trie \u00e0 notre table.</p> <pre><code>ALTER TABLE airports ADD COLUMN the_geom GEOMETRY ;\n</code></pre> <p>Puis on met \u00e0 jour cette colonne en cr\u00e9ant un point \u00e0 partir des colonnes <code>longitude_deg</code> et <code>latitude_deg</code> :</p> <pre><code>UPDATE airports SET the_geom = ST_POINT(longitude_deg, latitude_deg) ;\n</code></pre>"},{"location":"duckdb/exercice.html#exercice-2-recuperer-des-donnees-et-effectuer-nos-premiers-traitements-geographiques","title":"Exercice 2 : R\u00e9cup\u00e9rer des donn\u00e9es et effectuer nos premiers traitements g\u00e9ographiques","text":""},{"location":"duckdb/exercice.html#lancer-linterface-web-de-duckdb","title":"Lancer l'interface web de DuckDB","text":"<p>Tip</p> <p>Pour un peu plus de confort, on va r\u00e9aliser cet exercice dans l'interface web fournie avec l'ex\u00e9cutable DuckDB, l'\u00e9quivalent de <code>PgAdmin</code> pour DuckDB.</p> <p>Il faut, depuis un terminal, se placer dans le dossier o\u00f9 vous avez t\u00e9l\u00e9charg\u00e9 l'ex\u00e9cutable, par exemple :</p> <pre><code>cd C:\\Users\\florent\\\n</code></pre> <p>Puis lancer l'ex\u00e9cutable avec l'option <code>-ui</code> :</p> <pre><code>duckdb.exe -ui\n</code></pre> <p>Une fen\u00eatre va s'ouvrir dans votre navigateur web \u00e0 l'adresse <code>http://localhost:4213/</code></p> <p></p> <p>Une fois dans cette interface, on peut de nouveau se connecter \u00e0 la base de donn\u00e9es cr\u00e9\u00e9e lors de l'exercice 1.</p>"},{"location":"duckdb/exercice.html#recuperer-et-explorer-des-donnees-au-format-parquet","title":"R\u00e9cup\u00e9rer et explorer des donn\u00e9es au format Parquet","text":"<p>Nous allons utiliser ce jeu de donn\u00e9es : https://public.opendatasoft.com/explore/assets/geonames-all-cities-with-a-population-1000/</p> <p>Depuis l'onglet <code>export</code>, on peut r\u00e9cup\u00e9rer l'URL du fichier Parquet.</p> <pre><code>https://public.opendatasoft.com/api/explore/v2.1/catalog/datasets/geonames-all-cities-with-a-population-1000/exports/parquet/?lang=fr&amp;timezone=Europe%2FParis\n</code></pre> <p>Tip</p> <p>Nous n'avons pas besoin de t\u00e9l\u00e9charger le fichier, nous allons directement fournir l'URL du fichier Parquet dans notre requ\u00eate.</p> <p>Pour lire un fichier distant, il est n\u00e9cessaire de charger une autre extension :</p> <pre><code>load httpfs ;\n</code></pre> <p>On regarde \u00e0 quoi ressemblent nos donn\u00e9es :</p> <pre><code>SELECT * FROM read_parquet('https://public.opendatasoft.com/api/explore/v2.1/catalog/datasets/geonames-all-cities-with-a-population-1000/exports/parquet/?lang=fr&amp;timezone=Europe%2FParis')\nLIMIT 10; \n</code></pre> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 geoname_id \u2502         name         \u2502      ascii_name      \u2502   alternate_names    \u2502 feature_class \u2502 feature_code \u2502 \u2026 \u2502 elevation \u2502  dem  \u2502      timezone       \u2502 modification_date \u2502      label_en      \u2502     coordinates      \u2502\n\u2502  varchar   \u2502       varchar        \u2502       varchar        \u2502       varchar        \u2502    varchar    \u2502   varchar    \u2502   \u2502  varchar  \u2502 int64 \u2502       varchar       \u2502       date        \u2502      varchar       \u2502         blob         \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 696359     \u2502 Peredmistna Slobidka \u2502 Peredmistna Slobidka \u2502 Predmostnaya,Predm\u2026  \u2502 P             \u2502 PPL          \u2502 \u2026 \u2502 NULL      \u2502   101 \u2502 Europe/Kyiv         \u2502 2025-10-19        \u2502 Ukraine            \u2502 \\x01\\x01\\x00\\x00\\x\u2026  \u2502\n\u2502 12495567   \u2502 Harbour Main-Chape\u2026  \u2502 Harbour Main-Chape\u2026  \u2502 NULL                 \u2502 P             \u2502 PPL          \u2502 \u2026 \u2502 NULL      \u2502    54 \u2502 America/St_Johns    \u2502 2024-05-21        \u2502 Canada             \u2502 \\x01\\x01\\x00\\x00\\x\u2026  \u2502\n\u2502 4003914    \u2502 J. Jes\u00fas D\u00edaz Tzirio \u2502 J. Jesus Diaz Tzirio \u2502 NULL                 \u2502 P             \u2502 PPL          \u2502 \u2026 \u2502 NULL      \u2502  2257 \u2502 America/Mexico_City \u2502 2013-08-01        \u2502 Mexico             \u2502 \\x01\\x01\\x00\\x00\\x\u2026  \u2502\n\u2502 906044     \u2502 Monze                \u2502 Monze                \u2502 Monze                \u2502 P             \u2502 PPL          \u2502 \u2026 \u2502 NULL      \u2502  1124 \u2502 Africa/Lusaka       \u2502 2024-12-02        \u2502 Zambia             \u2502 \\x01\\x01\\x00\\x00\\x\u2026  \u2502\n\u2502 8859205    \u2502 Loma de los Hoyos    \u2502 Loma de los Hoyos    \u2502 Loma de los Hoyos    \u2502 P             \u2502 PPL          \u2502 \u2026 \u2502 NULL      \u2502   242 \u2502 America/Mexico_City \u2502 2014-04-11        \u2502 Mexico             \u2502 \\x01\\x01\\x00\\x00\\x\u2026  \u2502\n\u2502 13513017   \u2502 South Westminster    \u2502 South Westminster    \u2502 NULL                 \u2502 P             \u2502 PPLX         \u2502 \u2026 \u2502 NULL      \u2502    22 \u2502 America/Vancouver   \u2502 2025-09-08        \u2502 Canada             \u2502 \\x01\\x01\\x00\\x00\\x\u2026  \u2502\n\u2502 13527032   \u2502 Anse Royale          \u2502 Anse Royale          \u2502 NULL                 \u2502 P             \u2502 PPLX         \u2502 \u2026 \u2502 NULL      \u2502     4 \u2502 Indian/Mahe         \u2502 2025-10-02        \u2502 Seychelles         \u2502 \\x01\\x01\\x00\\x00\\x\u2026  \u2502\n\u2502 2017537    \u2502 Putyatin             \u2502 Putyatin             \u2502 Putjatin,Putyatin,\u2026  \u2502 P             \u2502 PPL          \u2502 \u2026 \u2502 NULL      \u2502    14 \u2502 Asia/Vladivostok    \u2502 2024-04-20        \u2502 Russian Federation \u2502 \\x01\\x01\\x00\\x00\\x\u2026  \u2502\n\u2502 13191985   \u2502 The Villas at Aeloa  \u2502 The Villas at Aeloa  \u2502 Aeloa,Kapolei Aelo\u2026  \u2502 P             \u2502 PPLX         \u2502 \u2026 \u2502 NULL      \u2502    27 \u2502 Pacific/Honolulu    \u2502 2025-01-13        \u2502 United States      \u2502 \\x01\\x01\\x00\\x00\\x\u2026  \u2502\n\u2502 4295940    \u2502 Ironville            \u2502 Ironville            \u2502 Ironville,ai en we\u2026  \u2502 P             \u2502 PPL          \u2502 \u2026 \u2502 219       \u2502   221 \u2502 America/New_York    \u2502 2012-07-14        \u2502 United States      \u2502 \\x01\\x01\\x00\\x00\\x\u2026  \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 10 rows                                                                                                                                                                                                20 columns (12 shown) \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre> <p>Warning</p> <p>Je n'ai pas fait le <code>load spatial</code>, donc la colonne de g\u00e9om\u00e9trie est mal interpr\u00e9t\u00e9e : elle est de type blob. </p> <p>Apr\u00e8s avoir refait le <code>load spatial</code>, j'obtiens une colonne de g\u00e9om\u00e9trie bien interpr\u00e9t\u00e9e.</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 geoname_id \u2502         name         \u2502      ascii_name      \u2502   alternate_names    \u2502 feature_class \u2502 feature_code \u2502 \u2026 \u2502 elevation \u2502  dem  \u2502      timezone       \u2502 modification_date \u2502      label_en      \u2502     coordinates      \u2502\n\u2502  varchar   \u2502       varchar        \u2502       varchar        \u2502       varchar        \u2502    varchar    \u2502   varchar    \u2502   \u2502  varchar  \u2502 int64 \u2502       varchar       \u2502       date        \u2502      varchar       \u2502       geometry       \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 696359     \u2502 Peredmistna Slobidka \u2502 Peredmistna Slobidka \u2502 Predmostnaya,Predm\u2026  \u2502 P             \u2502 PPL          \u2502 \u2026 \u2502 NULL      \u2502   101 \u2502 Europe/Kyiv         \u2502 2025-10-19        \u2502 Ukraine            \u2502 POINT (30.58333 50\u2026  \u2502\n\u2502 12495567   \u2502 Harbour Main-Chape\u2026  \u2502 Harbour Main-Chape\u2026  \u2502 NULL                 \u2502 P             \u2502 PPL          \u2502 \u2026 \u2502 NULL      \u2502    54 \u2502 America/St_Johns    \u2502 2024-05-21        \u2502 Canada             \u2502 POINT (-53.1744 47\u2026  \u2502\n\u2502 4003914    \u2502 J. Jes\u00fas D\u00edaz Tzirio \u2502 J. Jesus Diaz Tzirio \u2502 NULL                 \u2502 P             \u2502 PPL          \u2502 \u2026 \u2502 NULL      \u2502  2257 \u2502 America/Mexico_City \u2502 2013-08-01        \u2502 Mexico             \u2502 POINT (-102.39722 \u2026  \u2502\n\u2502 906044     \u2502 Monze                \u2502 Monze                \u2502 Monze                \u2502 P             \u2502 PPL          \u2502 \u2026 \u2502 NULL      \u2502  1124 \u2502 Africa/Lusaka       \u2502 2024-12-02        \u2502 Zambia             \u2502 POINT (27.48333 -1\u2026  \u2502\n\u2502 8859205    \u2502 Loma de los Hoyos    \u2502 Loma de los Hoyos    \u2502 Loma de los Hoyos    \u2502 P             \u2502 PPL          \u2502 \u2026 \u2502 NULL      \u2502   242 \u2502 America/Mexico_City \u2502 2014-04-11        \u2502 Mexico             \u2502 POINT (-102.44278 \u2026  \u2502\n\u2502 13513017   \u2502 South Westminster    \u2502 South Westminster    \u2502 NULL                 \u2502 P             \u2502 PPLX         \u2502 \u2026 \u2502 NULL      \u2502    22 \u2502 America/Vancouver   \u2502 2025-09-08        \u2502 Canada             \u2502 POINT (-122.87861 \u2026  \u2502\n\u2502 13527032   \u2502 Anse Royale          \u2502 Anse Royale          \u2502 NULL                 \u2502 P             \u2502 PPLX         \u2502 \u2026 \u2502 NULL      \u2502     4 \u2502 Indian/Mahe         \u2502 2025-10-02        \u2502 Seychelles         \u2502 POINT (55.50333 -4\u2026  \u2502\n\u2502 2017537    \u2502 Putyatin             \u2502 Putyatin             \u2502 Putjatin,Putyatin,\u2026  \u2502 P             \u2502 PPL          \u2502 \u2026 \u2502 NULL      \u2502    14 \u2502 Asia/Vladivostok    \u2502 2024-04-20        \u2502 Russian Federation \u2502 POINT (132.41599 4\u2026  \u2502\n\u2502 13191985   \u2502 The Villas at Aeloa  \u2502 The Villas at Aeloa  \u2502 Aeloa,Kapolei Aelo\u2026  \u2502 P             \u2502 PPLX         \u2502 \u2026 \u2502 NULL      \u2502    27 \u2502 Pacific/Honolulu    \u2502 2025-01-13        \u2502 United States      \u2502 POINT (-158.06726 \u2026  \u2502\n\u2502 4295940    \u2502 Ironville            \u2502 Ironville            \u2502 Ironville,ai en we\u2026  \u2502 P             \u2502 PPL          \u2502 \u2026 \u2502 219       \u2502   221 \u2502 America/New_York    \u2502 2012-07-14        \u2502 United States      \u2502 POINT (-82.69238 3\u2026  \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 10 rows                                                                                                                                                                                                20 columns (12 shown) \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre> <p>On ne va pas garder toutes les colonnes. On va faire un <code>DESCRIBE</code> pour voir ce qui est disponible.</p> <pre><code>D DESCRIBE SELECT * \nFROM read_parquet('https://public.opendatasoft.com/api/explore/v2.1/catalog/datasets/geonames-all-cities-with-a-population-1000/exports/parquet/?lang=fr&amp;timezone=Europe%2FParis')\nLIMIT 1 ;\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502    column_name    \u2502 column_type \u2502  null   \u2502   key   \u2502 default \u2502  extra  \u2502\n\u2502      varchar      \u2502   varchar   \u2502 varchar \u2502 varchar \u2502 varchar \u2502 varchar \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 geoname_id        \u2502 VARCHAR     \u2502 YES     \u2502 NULL    \u2502 NULL    \u2502 NULL    \u2502\n\u2502 name              \u2502 VARCHAR     \u2502 YES     \u2502 NULL    \u2502 NULL    \u2502 NULL    \u2502\n\u2502 ascii_name        \u2502 VARCHAR     \u2502 YES     \u2502 NULL    \u2502 NULL    \u2502 NULL    \u2502\n\u2502 alternate_names   \u2502 VARCHAR     \u2502 YES     \u2502 NULL    \u2502 NULL    \u2502 NULL    \u2502\n\u2502 feature_class     \u2502 VARCHAR     \u2502 YES     \u2502 NULL    \u2502 NULL    \u2502 NULL    \u2502\n\u2502 feature_code      \u2502 VARCHAR     \u2502 YES     \u2502 NULL    \u2502 NULL    \u2502 NULL    \u2502\n\u2502 country_code      \u2502 VARCHAR     \u2502 YES     \u2502 NULL    \u2502 NULL    \u2502 NULL    \u2502\n\u2502 cou_name_en       \u2502 VARCHAR     \u2502 YES     \u2502 NULL    \u2502 NULL    \u2502 NULL    \u2502\n\u2502 country_code_2    \u2502 VARCHAR     \u2502 YES     \u2502 NULL    \u2502 NULL    \u2502 NULL    \u2502\n\u2502 admin1_code       \u2502 VARCHAR     \u2502 YES     \u2502 NULL    \u2502 NULL    \u2502 NULL    \u2502\n\u2502 admin2_code       \u2502 VARCHAR     \u2502 YES     \u2502 NULL    \u2502 NULL    \u2502 NULL    \u2502\n\u2502 admin3_code       \u2502 BIGINT      \u2502 YES     \u2502 NULL    \u2502 NULL    \u2502 NULL    \u2502\n\u2502 admin4_code       \u2502 VARCHAR     \u2502 YES     \u2502 NULL    \u2502 NULL    \u2502 NULL    \u2502\n\u2502 population        \u2502 BIGINT      \u2502 YES     \u2502 NULL    \u2502 NULL    \u2502 NULL    \u2502\n\u2502 elevation         \u2502 VARCHAR     \u2502 YES     \u2502 NULL    \u2502 NULL    \u2502 NULL    \u2502\n\u2502 dem               \u2502 BIGINT      \u2502 YES     \u2502 NULL    \u2502 NULL    \u2502 NULL    \u2502\n\u2502 timezone          \u2502 VARCHAR     \u2502 YES     \u2502 NULL    \u2502 NULL    \u2502 NULL    \u2502\n\u2502 modification_date \u2502 DATE        \u2502 YES     \u2502 NULL    \u2502 NULL    \u2502 NULL    \u2502\n\u2502 label_en          \u2502 VARCHAR     \u2502 YES     \u2502 NULL    \u2502 NULL    \u2502 NULL    \u2502\n\u2502 coordinates       \u2502 GEOMETRY    \u2502 YES     \u2502 NULL    \u2502 NULL    \u2502 NULL    \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 20 rows                                                       6 columns \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre> <p>Tip</p> <p>En utilisant <code>DESCRIBE</code> de cette mani\u00e8re, on est tout de m\u00eame oblig\u00e9 de r\u00e9cup\u00e9rer des donn\u00e9es pour obtenir la description de la table. Il existe une m\u00e9thode plus efficace : la fonction <code>parquet_schema</code>. Cette fonction lit uniquement le footer du fichier Parquet (quelques Ko), qui contient le sch\u00e9ma, sans charger les donn\u00e9es. Cela fonctionne parfaitement avec des fichiers locaux ou des URLs pointant vers des fichiers Parquet statiques.</p> <pre><code>D SELECT * FROM parquet_schema('https://public.opendatasoft.com/api/explore/v2.1/catalog/datasets/geonames-all-cities-with-a-population-1000/exports/parquet/?lang=fr&amp;timezone=Europe%2FParis');\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                                 file_name                                 \u2502       name        \u2502    type    \u2502 type_length \u2502 repetition_type \u2502 num_children \u2502 converted_type \u2502 scale \u2502 precision \u2502 field_id \u2502 logical_type \u2502 duckdb_type \u2502\n\u2502                                  varchar                                  \u2502      varchar      \u2502  varchar   \u2502   varchar   \u2502     varchar     \u2502    int64     \u2502    varchar     \u2502 int64 \u2502   int64   \u2502  int64   \u2502   varchar    \u2502   varchar   \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 https://public.opendatasoft.com/api/explore/v2.1/catalog/datasets/geona\u2026  \u2502 schema            \u2502 NULL       \u2502 NULL        \u2502 REQUIRED        \u2502           20 \u2502 NULL           \u2502  NULL \u2502      NULL \u2502     NULL \u2502 NULL         \u2502 NULL        \u2502\n\u2502 https://public.opendatasoft.com/api/explore/v2.1/catalog/datasets/geona\u2026  \u2502 geoname_id        \u2502 BYTE_ARRAY \u2502 NULL        \u2502 OPTIONAL        \u2502         NULL \u2502 UTF8           \u2502  NULL \u2502      NULL \u2502     NULL \u2502 StringType() \u2502 VARCHAR     \u2502\n\u2502 https://public.opendatasoft.com/api/explore/v2.1/catalog/datasets/geona\u2026  \u2502 name              \u2502 BYTE_ARRAY \u2502 NULL        \u2502 OPTIONAL        \u2502         NULL \u2502 UTF8           \u2502  NULL \u2502      NULL \u2502     NULL \u2502 StringType() \u2502 VARCHAR     \u2502\n\u2502 https://public.opendatasoft.com/api/explore/v2.1/catalog/datasets/geona\u2026  \u2502 ascii_name        \u2502 BYTE_ARRAY \u2502 NULL        \u2502 OPTIONAL        \u2502         NULL \u2502 UTF8           \u2502  NULL \u2502      NULL \u2502     NULL \u2502 StringType() \u2502 VARCHAR     \u2502\n\u2502 https://public.opendatasoft.com/api/explore/v2.1/catalog/datasets/geona\u2026  \u2502 alternate_names   \u2502 BYTE_ARRAY \u2502 NULL        \u2502 OPTIONAL        \u2502         NULL \u2502 UTF8           \u2502  NULL \u2502      NULL \u2502     NULL \u2502 StringType() \u2502 VARCHAR     \u2502\n\u2502 https://public.opendatasoft.com/api/explore/v2.1/catalog/datasets/geona\u2026  \u2502 feature_class     \u2502 BYTE_ARRAY \u2502 NULL        \u2502 OPTIONAL        \u2502         NULL \u2502 UTF8           \u2502  NULL \u2502      NULL \u2502     NULL \u2502 StringType() \u2502 VARCHAR     \u2502\n\u2502 https://public.opendatasoft.com/api/explore/v2.1/catalog/datasets/geona\u2026  \u2502 feature_code      \u2502 BYTE_ARRAY \u2502 NULL        \u2502 OPTIONAL        \u2502         NULL \u2502 UTF8           \u2502  NULL \u2502      NULL \u2502     NULL \u2502 StringType() \u2502 VARCHAR     \u2502\n\u2502 https://public.opendatasoft.com/api/explore/v2.1/catalog/datasets/geona\u2026  \u2502 country_code      \u2502 BYTE_ARRAY \u2502 NULL        \u2502 OPTIONAL        \u2502         NULL \u2502 UTF8           \u2502  NULL \u2502      NULL \u2502     NULL \u2502 StringType() \u2502 VARCHAR     \u2502\n\u2502 https://public.opendatasoft.com/api/explore/v2.1/catalog/datasets/geona\u2026  \u2502 cou_name_en       \u2502 BYTE_ARRAY \u2502 NULL        \u2502 OPTIONAL        \u2502         NULL \u2502 UTF8           \u2502  NULL \u2502      NULL \u2502     NULL \u2502 StringType() \u2502 VARCHAR     \u2502\n\u2502 https://public.opendatasoft.com/api/explore/v2.1/catalog/datasets/geona\u2026  \u2502 country_code_2    \u2502 BYTE_ARRAY \u2502 NULL        \u2502 OPTIONAL        \u2502         NULL \u2502 UTF8           \u2502  NULL \u2502      NULL \u2502     NULL \u2502 StringType() \u2502 VARCHAR     \u2502\n\u2502 https://public.opendatasoft.com/api/explore/v2.1/catalog/datasets/geona\u2026  \u2502 admin1_code       \u2502 BYTE_ARRAY \u2502 NULL        \u2502 OPTIONAL        \u2502         NULL \u2502 UTF8           \u2502  NULL \u2502      NULL \u2502     NULL \u2502 StringType() \u2502 VARCHAR     \u2502\n\u2502 https://public.opendatasoft.com/api/explore/v2.1/catalog/datasets/geona\u2026  \u2502 admin2_code       \u2502 BYTE_ARRAY \u2502 NULL        \u2502 OPTIONAL        \u2502         NULL \u2502 UTF8           \u2502  NULL \u2502      NULL \u2502     NULL \u2502 StringType() \u2502 VARCHAR     \u2502\n\u2502 https://public.opendatasoft.com/api/explore/v2.1/catalog/datasets/geona\u2026  \u2502 admin3_code       \u2502 INT64      \u2502 NULL        \u2502 OPTIONAL        \u2502         NULL \u2502 NULL           \u2502  NULL \u2502      NULL \u2502     NULL \u2502 NULL         \u2502 BIGINT      \u2502\n\u2502 https://public.opendatasoft.com/api/explore/v2.1/catalog/datasets/geona\u2026  \u2502 admin4_code       \u2502 BYTE_ARRAY \u2502 NULL        \u2502 OPTIONAL        \u2502         NULL \u2502 UTF8           \u2502  NULL \u2502      NULL \u2502     NULL \u2502 StringType() \u2502 VARCHAR     \u2502\n\u2502 https://public.opendatasoft.com/api/explore/v2.1/catalog/datasets/geona\u2026  \u2502 population        \u2502 INT64      \u2502 NULL        \u2502 OPTIONAL        \u2502         NULL \u2502 NULL           \u2502  NULL \u2502      NULL \u2502     NULL \u2502 NULL         \u2502 BIGINT      \u2502\n\u2502 https://public.opendatasoft.com/api/explore/v2.1/catalog/datasets/geona\u2026  \u2502 elevation         \u2502 BYTE_ARRAY \u2502 NULL        \u2502 OPTIONAL        \u2502         NULL \u2502 UTF8           \u2502  NULL \u2502      NULL \u2502     NULL \u2502 StringType() \u2502 VARCHAR     \u2502\n\u2502 https://public.opendatasoft.com/api/explore/v2.1/catalog/datasets/geona\u2026  \u2502 dem               \u2502 INT64      \u2502 NULL        \u2502 OPTIONAL        \u2502         NULL \u2502 NULL           \u2502  NULL \u2502      NULL \u2502     NULL \u2502 NULL         \u2502 BIGINT      \u2502\n\u2502 https://public.opendatasoft.com/api/explore/v2.1/catalog/datasets/geona\u2026  \u2502 timezone          \u2502 BYTE_ARRAY \u2502 NULL        \u2502 OPTIONAL        \u2502         NULL \u2502 UTF8           \u2502  NULL \u2502      NULL \u2502     NULL \u2502 StringType() \u2502 VARCHAR     \u2502\n\u2502 https://public.opendatasoft.com/api/explore/v2.1/catalog/datasets/geona\u2026  \u2502 modification_date \u2502 INT32      \u2502 NULL        \u2502 OPTIONAL        \u2502         NULL \u2502 DATE           \u2502  NULL \u2502      NULL \u2502     NULL \u2502 DateType()   \u2502 DATE        \u2502\n\u2502 https://public.opendatasoft.com/api/explore/v2.1/catalog/datasets/geona\u2026  \u2502 label_en          \u2502 BYTE_ARRAY \u2502 NULL        \u2502 OPTIONAL        \u2502         NULL \u2502 UTF8           \u2502  NULL \u2502      NULL \u2502     NULL \u2502 StringType() \u2502 VARCHAR     \u2502\n\u2502 https://public.opendatasoft.com/api/explore/v2.1/catalog/datasets/geona\u2026  \u2502 coordinates       \u2502 BYTE_ARRAY \u2502 NULL        \u2502 OPTIONAL        \u2502         NULL \u2502 NULL           \u2502  NULL \u2502      NULL \u2502     NULL \u2502 NULL         \u2502 BLOB        \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 21 rows                                                                                                                                                                                                                     12 columns \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"duckdb/exercice.html#creer-une-table-a-partir-dun-fichier-parquet","title":"Cr\u00e9er une table \u00e0 partir d'un fichier Parquet","text":"<p>Warning</p> <p>Attention aux fichiers Parquet distants. Tous les serveurs ne sont pas compatibles avec les requ\u00eates HTTP Range. Dans ce cas, DuckDB ne peut pas tirer parti du stockage en colonnes pour ne t\u00e9l\u00e9charger que ce dont il a besoin \u2014 il est forc\u00e9 de tout r\u00e9cup\u00e9rer d'un coup, ce qui peut provoquer des erreurs.</p> <p>La solution est d'utiliser <code>SET force_download=true;</code> pour indiquer \u00e0 DuckDB de t\u00e9l\u00e9charger le fichier en entier avant de l'interroger.</p> <p>Si le fichier Parquet \u00e9tait en local, ce probl\u00e8me n'existerait pas : DuckDB lirait directement les colonnes n\u00e9cessaires sur votre disque, sans contrainte r\u00e9seau, et profiterait pleinement de tous les avantages du format (column pruning, predicate pushdown...).</p> <p>Retenez donc que les gains de performance de Parquet sont maximaux quand les fichiers sont en local ou sur un stockage cloud bien configur\u00e9 (S3, GCS, Azure Blob).</p> <p>On va donc ex\u00e9cuter <code>SET force_download=true;</code> (sauf si vous avez t\u00e9l\u00e9charg\u00e9 le fichier Parquet en local).</p> <p>On va cr\u00e9er une table dans notre base en ne gardant que certaines colonnes et les villes fran\u00e7aises.</p> <pre><code>CREATE TABLE villes_1000_hab_fr AS SELECT geoname_id, name, population, elevation, coordinates \nFROM read_parquet('https://public.opendatasoft.com/api/explore/v2.1/catalog/datasets/geonames-all-cities-with-a-population-1000/exports/parquet/?lang=fr&amp;timezone=Europe%2FParis')\nWHERE country_code = 'FR' ;\n</code></pre> <p>On v\u00e9rifie qu'on a bien r\u00e9cup\u00e9r\u00e9 des donn\u00e9es :</p> <pre><code>D SELECT * FROM villes_1000_hab_fr LIMIT 5 ;\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 geoname_id \u2502          name          \u2502 population \u2502 elevation \u2502        coordinates        \u2502\n\u2502  varchar   \u2502        varchar         \u2502   int64    \u2502  varchar  \u2502         geometry          \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 2967230    \u2502 Ymare                  \u2502       1060 \u2502 NULL      \u2502 POINT (1.17938 49.3506)   \u2502\n\u2502 2967234    \u2502 Yffiniac               \u2502       4392 \u2502 NULL      \u2502 POINT (-2.67757 48.48479) \u2502\n\u2502 2967350    \u2502 Wimille                \u2502       4825 \u2502 NULL      \u2502 POINT (1.63137 50.76418)  \u2502\n\u2502 2967414    \u2502 Wavrechain-sous-Denain \u2502       1769 \u2502 NULL      \u2502 POINT (3.41252 50.33224)  \u2502\n\u2502 2967506    \u2502 Walbourg               \u2502       1161 \u2502 NULL      \u2502 POINT (7.78828 48.88628)  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"duckdb/exercice.html#utiliser-les-fonctions-spatiales-de-duckdb","title":"Utiliser les fonctions spatiales de DuckDB","text":"<p>L'objectif est d'ajouter une colonne d\u00e9partements \u00e0 notre table des villes fran\u00e7aises de plus de 1 000 habitants, via une jointure spatiale.</p> <p>Vous trouverez ici une couche des d\u00e9partements.</p> <p>On va maintenant int\u00e9grer ce GeoJSON dans notre base de donn\u00e9es. Pour cela, nous allons utiliser la fonction <code>st_read</code>, document\u00e9e ici. Elle nous permet de lire un fichier spatial dans une clause <code>FROM</code> ; divers formats sont support\u00e9s gr\u00e2ce \u00e0 l'utilisation de GDAL.</p> <pre><code>CREATE TABLE departement AS\nSELECT * FROM st_read('/home/florent/perso/cours/docs/assets/data/departements.geojson');\n</code></pre> <p>V\u00e9rifions que la table est bien int\u00e9gr\u00e9e.</p> <pre><code>D SELECT * FROM departement LIMIT 2 ;\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 DDEP_C_COD \u2502 DDEP_L_LIB \u2502      DREG_L_LIB      \u2502                                                                                         geom                                                                                          \u2502\n\u2502  varchar   \u2502  varchar   \u2502       varchar        \u2502                                                                                       geometry                                                                                        \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 01         \u2502 Ain        \u2502 Auvergne-Rh\u00f4ne-Alpes \u2502 POLYGON ((6.1684513 46.3674591, 6.1666758 46.3707436, 6.1609838 46.3765521, 6.1471235 46.3798282, 6.1204011 46.3959546, 6.1065032 46.3998394, 6.0975256 46.4082841, 6.0640085 46.41\u2026  \u2502\n\u2502 02         \u2502 Aisne      \u2502 Hauts-de-France      \u2502 POLYGON ((4.2557339 49.9039769, 4.2369361 49.9037822, 4.2336436 49.9091161, 4.2221419 49.9104265, 4.2177737 49.9162558, 4.2202062 49.9335887, 4.2321319 49.9559556, 4.2330683 49.95\u2026  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre> <p>Ajoutons maintenant une colonne <code>code_dep</code> \u00e0 notre table <code>villes_1000_hab_fr</code>.</p> <p>Pour cela, deux solutions s'offrent \u00e0 nous :</p> <ul> <li>Cr\u00e9er d'abord la colonne, puis la remplir via une instruction <code>UPDATE</code></li> <li>Cr\u00e9er une nouvelle table et supprimer l'ancienne</li> </ul>"},{"location":"duckdb/exercice.html#option-1-creer-la-colonne-et-la-mettre-a-jour-ensuite","title":"Option 1 : cr\u00e9er la colonne et la mettre \u00e0 jour ensuite","text":"<pre><code>ALTER TABLE villes_1000_hab_fr ADD COLUMN code_dep VARCHAR;\n\nUPDATE villes_1000_hab_fr\nSET code_dep = d.DDEP_C_COD\nFROM departement d\nWHERE ST_Within(villes_1000_hab_fr.coordinates, d.geom);\n</code></pre>"},{"location":"duckdb/exercice.html#option-2-nouvelle-table","title":"Option 2 : nouvelle table","text":"<pre><code>CREATE TABLE villes_1000_hab_fr_new AS\nSELECT v.*, d.DDEP_C_COD AS code_dep\nFROM villes_1000_hab_fr v\nJOIN departement d\n  ON ST_Within(v.coordinates, d.geom);\n\nDROP TABLE villes_1000_hab_fr;\n\nALTER TABLE villes_1000_hab_fr_new RENAME TO villes_1000_hab_fr;\n</code></pre>"},{"location":"duckdb/exercice.html#exercice-3-utiliser-le-plugin-qgis-et-visualiser-nos-donnees","title":"Exercice 3 : Utiliser le plugin QGIS et visualiser nos donn\u00e9es","text":""},{"location":"duckdb/exercice.html#installer-le-plugin-qgis","title":"Installer le plugin QGIS","text":"<p>Depuis le gestionnaire des extensions QGIS.</p> <p></p> <p>Warning</p> <p>Si vous \u00eates sur Windows, le plugin int\u00e8gre la d\u00e9pendance Python <code>duckdb</code>, il n'y a donc rien \u00e0 faire de plus. En revanche, si vous \u00eates sur macOS ou Linux, il faut consulter la documentation du plugin.</p>"},{"location":"duckdb/exercice.html#visualiser-dans-qgis-les-couches-realisees-dans-les-exercices-1-et-2","title":"Visualiser dans QGIS les couches r\u00e9alis\u00e9es dans les exercices 1 et 2","text":"<p>Dans votre barre des extensions de QGIS, vous trouverez une ic\u00f4ne DuckDB qui lance l'interface du plugin. Chargez votre base de donn\u00e9es.</p> <p>Warning</p> <p>DuckDB ne conna\u00eet pas (encore) la projection des donn\u00e9es, il est imp\u00e9ratif de la pr\u00e9ciser.</p> <p></p> <p>Info</p> <p>Nous avons cr\u00e9\u00e9 nos tables sans pr\u00e9ciser de sch\u00e9ma, elles se trouvent donc dans le sch\u00e9ma <code>main</code> (\u00e9quivalent du sch\u00e9ma <code>public</code> de PostGIS).</p> <p>Exemple de visualisation, notre couche <code>villes_1000_hab_fr</code> :</p> <p></p>"},{"location":"duckdb/exercice.html#executer-des-selections-sql-depuis-le-plugin","title":"Ex\u00e9cuter des s\u00e9lections SQL depuis le plugin","text":"<p>Depuis le plugin, il est possible de charger des couches via des requ\u00eates SQL.</p>"},{"location":"duckdb/exercice.html#chargement-des-villes-du-departement-35","title":"Chargement des villes du d\u00e9partement 35","text":"<pre><code>SELECT * \nFROM villes_1000_hab_fr\nWHERE code_dep = '35'\n</code></pre>"},{"location":"duckdb/exercice.html#chargement-dune-couche-de-buffer-autour-des-points","title":"Chargement d'une couche de buffer autour des points","text":"<p>Warning</p> <p>Notre couche est en WGS84 (<code>EPSG:4326</code>). Si on effectue un buffer sans convertir vers une projection m\u00e9trique, la distance sera exprim\u00e9e en degr\u00e9s. Il faut donc forcer une transformation en Lambert-93 \u00e0 l'aide de la fonction <code>ST_Transform</code> et indiquer \u00e0 QGIS que la couche est en <code>EPSG:2154</code>.</p> <pre><code>SELECT name, population, \n    ST_Buffer(ST_Transform(coordinates, 'EPSG:4326','EPSG:2154'), 10000) as geom\nFROM villes_1000_hab_fr\nWHERE code_dep = '35';\n</code></pre> <p></p>"},{"location":"duckdb/exercice.html#exercice-4-traiter-des-donnees-parquet-doverture-maps-avec-duckdb","title":"Exercice 4 : Traiter des donn\u00e9es parquet d'Overture Maps avec DuckDB","text":"<p>Cet exercice est issus de mon article sur DuckDB publi\u00e9 sur G\u00e9otribu</p> <p>Abstract</p> <p>Les donn\u00e9es Overture Maps sont une base de donn\u00e9es cartographique ouverte qui d\u00e9crit des \u00e9l\u00e9ments du monde r\u00e9el comme les routes, les b\u00e2timents, les adresses ou les lieux. Le projet est g\u00e9r\u00e9 par la Overture Maps Foundation, une organisation cr\u00e9\u00e9e par de grandes entreprises technologiques comme Amazon, Microsoft, Meta et TomTom,</p> <p>Les donn\u00e9es d\u2019Overture Maps sont fournies sous forme de fichier Parquet (d\u00e9crites ici), nous allons donc importer ces donn\u00e9es dans une base pour les consulter.</p>"},{"location":"duckdb/exercice.html#importer-les-donnees-dans-la-base","title":"Importer les donn\u00e9es dans la base","text":"<p>Dans cet exemple, on r\u00e9cup\u00e8re 100 b\u00e2timents al\u00e9atoirement.</p> <pre><code>CREATE TABLE buildings AS (\nSELECT\n    type, version, height, level, class, JSON(names) as names, JSON(sources) as sources, geometry\nFROM\n    read_parquet('s3://overturemaps-us-west-2/release/2026-01-21.0/theme=buildings/type=building/*.parquet', hive_partitioning=1)\nLIMIT 100);\n</code></pre> <p>Dans cet autre exemple, on r\u00e9cup\u00e8re les b\u00e2timents d\u2019une partie de la ville de Laval en indiquant les coordonn\u00e9es d\u2019un rectangle.</p> <pre><code>CREATE TABLE laval_buildings AS ( \nSELECT\n    type, version, height, level, JSON(names) as names, JSON(sources) as sources, geometry\nFROM\n    read_parquet('s3://overturemaps-us-west-2/release/2026-01-21.0/theme=buildings/type=building/*.parquet', hive_partitioning=1)\nWHERE \n    bbox.xmin &gt; -0.7948129589175504\n    AND bbox.xmax &lt; -0.7472280816538276\n    AND bbox.ymin &gt; 48.069335046027035\n    AND bbox.ymax &lt; 48.073450034830316);\n</code></pre>"},{"location":"duckdb/exercice.html#convertir-les-donnees-en-un-geojson-en-utilisant-duckdb","title":"Convertir les donn\u00e9es en un GeoJSON en utilisant DuckDB","text":"<p>Un des atouts de DuckDB est qu'en plus d\u2019int\u00e9grer des donn\u00e9es pour les traiter en base, il peut servir d\u2019outil de conversion pour des donn\u00e9es Parquet. Exemple : si on me donne des donn\u00e9es en Parquet et je souhaite des GeoJSON, DuckDB peut les convertir sans cr\u00e9er de table ni de base !</p> <pre><code>COPY (\n    SELECT\n        type,version, height, level, JSON(names) as names, JSON(sources) as sources, geometry\n    FROM\n        read_parquet('s3://overturemaps-us-west-2/release/2026-01-21.0/theme=buildings/type=building/*.parquet', hive_partitioning=1)\n    WHERE \n        bbox.xmin &gt; -0.7948129589175504\n        AND bbox.xmax &lt; -0.7472280816538276\n        AND bbox.ymin &gt; 48.069335046027035\n        AND bbox.ymax &lt; 48.073450034830316)\nTO 'laval_buildings.geojson'\nWITH (FORMAT GDAL, DRIVER 'GeoJSON', SRS 'EPSG:4326');\n</code></pre> <p> Il est \u00e9galement possible d'exporter en Shapefile, pour cela, il faut remplacer les deux derni\u00e8res lignes par celles-ci :</p> <pre><code>TO 'laval_buildings.shp'\nWITH (FORMAT GDAL, DRIVER 'ESRI Shapefile', SRS 'EPSG:4326');\n</code></pre>"},{"location":"duckdb/exercice.html#exercice-5-duckdb-avec-lopen-data-de-rennes-metropole","title":"Exercice 5 : DuckDB avec l'Open Data de Rennes M\u00e9tropole","text":"<p>Le portail Open Data de Rennes M\u00e9tropole fournit les donn\u00e9es au format Parquet.</p> <ul> <li>Int\u00e9grez dans une base DuckDB deux couches de votre choix</li> <li>Utilisez les fonctions spatiales de DuckDB pour croiser spatialement ces donn\u00e9es</li> <li>Chargez le r\u00e9sultat dans QGIS \u00e0 l'aide du plugin QDuckDB</li> </ul>"},{"location":"duckdb/exercice.html#correction","title":"Correction","text":"<p>On r\u00e9cup\u00e8re les couches station de m\u00e9tro et iris. On enrichie la couche des stations de m\u00e9tro avec le code IRIS.</p> <pre><code>INSTALL spatial ;\nLOAD spatial ;\n\nSET force_download=true;\n\nCREATE TABLE station_metro AS\nSELECT * FROM read_parquet('https://data.rennesmetropole.fr/api/explore/v2.1/catalog/datasets/metro_localisation_stations/exports/parquet?lang=fr&amp;timezone=Europe%2FBerlin')\n;\n\nALTER TABLE station_metro DROP COLUMN  geo_point_2d ;\n\nCREATE TABLE iris as SELECT *\nFROM read_parquet('https://data.rennesmetropole.fr/api/explore/v2.1/catalog/datasets/iris_version_rennes_metropole/exports/parquet?lang=fr&amp;timezone=Europe%2FBerlin');\n\nALTER TABLE station_metro ADD COLUMN iris VARCHAR ; \n\nUPDATE station_metro\nSET iris = d.code_iris\nFROM iris d\nWHERE ST_Within(station_metro.geo_shape, d.geo_shape);\n</code></pre>"},{"location":"duckdb/presentation.html","title":"Traitement de donn\u00e9es g\u00e9ospatiales","text":""},{"location":"duckdb/presentation.html#avec-parquet-et-duckdb","title":"avec Parquet et DuckDB","text":""},{"location":"duckdb/presentation.html#florent-fougeres","title":"\ud83d\udc4b Florent Foug\u00e8res","text":""},{"location":"duckdb/presentation.html#developpeur-sig-chez-oslandia","title":"D\u00e9veloppeur SIG chez Oslandia","text":""},{"location":"duckdb/presentation.html#florentfougeres","title":"@florentfougeres","text":""},{"location":"duckdb/presentation.html#florentfougeres_1","title":"@florentfougeres","text":""},{"location":"duckdb/presentation.html#florentfougeresgmailcom","title":"florent.fougeres@gmail.com","text":""},{"location":"duckdb/presentation.html#florent-fougeres_1","title":"Florent Foug\u00e8res","text":""},{"location":"duckdb/presentation.html#plan-du-cours","title":"Plan du cours","text":"<ol> <li>Introduction au format Parquet</li> <li>Le SGBD DuckDB : pr\u00e9sentation et caract\u00e9ristiques</li> <li>Performances et benchmarks</li> <li>Cas d'usage en SIG</li> <li>La compl\u00e9mentarit\u00e9 Parquet + DuckDB</li> <li>Exercices pratiques</li> </ol>"},{"location":"duckdb/presentation.html#1-introduction-au-format-parquet","title":"1. Introduction au format Parquet","text":""},{"location":"duckdb/presentation.html#quest-ce-que-parquet","title":"Qu'est-ce que Parquet ?","text":"<ul> <li>Format de fichier open source</li> <li>D\u00e9velopp\u00e9 par la Fondation Apache</li> <li>Con\u00e7u pour stocker et acc\u00e9der \u00e0 de grandes quantit\u00e9s de donn\u00e9es</li> <li>Architecture orient\u00e9e colonnes</li> <li>Compression efficace</li> <li>Extension Geoparquet pour les g\u00e9om\u00e9tries spatiales</li> </ul>"},{"location":"duckdb/presentation.html#architecture-orientee-colonnes","title":"Architecture orient\u00e9e colonnes","text":"<p>Format traditionnel (orient\u00e9 lignes) : <pre><code>Ligne 1: nom, pr\u00e9nom, ville, code_postal\nLigne 2: nom, pr\u00e9nom, ville, code_postal\nLigne 3: nom, pr\u00e9nom, ville, code_postal\n</code></pre></p> <p>Parquet (orient\u00e9 colonnes) : <pre><code>Colonne nom: [valeur1, valeur2, valeur3, ...]\nColonne pr\u00e9nom: [valeur1, valeur2, valeur3, ...]\nColonne ville: [valeur1, valeur2, valeur3, ...]\n</code></pre></p>"},{"location":"duckdb/presentation.html#avantages-de-larchitecture-colonnes","title":"Avantages de l'architecture colonnes","text":"<p>\u2705 Meilleure compression - Les donn\u00e9es d'une m\u00eame colonne sont souvent similaires</p> <p>\u2705 Lecture optimis\u00e9e - Ne lit que les colonnes n\u00e9cessaires</p> <p>\u2705 Performance analytique - Id\u00e9al pour les agr\u00e9gations et statistiques</p>"},{"location":"duckdb/presentation.html#organisation-en-dataset","title":"Organisation en dataset","text":"<p>Un dataset Parquet peut \u00eatre un dossier de fichiers :</p> <pre><code>/mon_dataset/\n  \u251c\u2500\u2500 partie_1.parquet\n  \u251c\u2500\u2500 partie_2.parquet\n  \u251c\u2500\u2500 partie_3.parquet\n  \u2514\u2500\u2500 partie_4.parquet\n</code></pre> <p>Avantages : - Traitement en parall\u00e8le (chunks) - Gestion efficace de gros volumes - Meilleure performance globale</p>"},{"location":"duckdb/presentation.html#geoparquet","title":"Geoparquet","text":"<p>https://geoparquet.org</p> <p>Extension de Parquet pour les donn\u00e9es g\u00e9ospatiales</p> <ul> <li>Stockage des g\u00e9om\u00e9tries spatiales</li> <li>Compatible avec tous les types g\u00e9om\u00e9triques</li> <li>M\u00e9tadonn\u00e9es spatiales (CRS, bbox, etc.)</li> <li>Tous les avantages de Parquet pr\u00e9serv\u00e9s</li> </ul>"},{"location":"duckdb/presentation.html#benchmark-comparaison-des-formats","title":"Benchmark : Comparaison des formats","text":"<p>Donn\u00e9es : Localit\u00e9s mondiales &gt; 1 000 habitants</p> Format Taille du fichier GeoJSON ~100 MB CSV ~80 MB Parquet ~20 MB <p>\u2192 Gain de taille : 5x plus compact que GeoJSON</p>"},{"location":"duckdb/presentation.html#limite-importante-de-parquet","title":"Limite importante de Parquet","text":"<p>\u26a0\ufe0f Parquet = format d'\u00e9change</p> <ul> <li>Pas un format de travail</li> <li>Pas un format de traitement</li> <li>N\u00e9cessite un syst\u00e8me optimis\u00e9 pour l'exploiter</li> </ul> <p>Solution : DuckDB</p>"},{"location":"duckdb/presentation.html#02","title":"02","text":""},{"location":"duckdb/presentation.html#le-sgbd-duckdb-presentation-et-caracteristiques","title":"Le SGBD DuckDB : pr\u00e9sentation et caract\u00e9ristiques","text":""},{"location":"duckdb/presentation.html#quest-ce-que-duckdb","title":"Qu'est-ce que DuckDB ?","text":"<p>Syst\u00e8me de gestion de base de donn\u00e9es relationnelle (SGBDR)</p> <ul> <li>\u00c9crit en C++</li> <li>Licence MIT (open source)</li> <li>Base de donn\u00e9es en fichier portable</li> <li>Version stable : 1.4.4</li> <li>Sans serveur (serverless)</li> </ul>"},{"location":"duckdb/presentation.html#pourquoi-choisir-duckdb","title":"Pourquoi choisir DuckDB ?","text":"<p>\u2705 Sans serveur (Serverless) - Pas de processus serveur \u00e0 g\u00e9rer - Configuration minimale</p> <p>\u2705 Installation rapide - Mise en place en quelques minutes</p> <p>\u2705 Fichier portable - Facilite le partage et la sauvegarde</p>"},{"location":"duckdb/presentation.html#pourquoi-choisir-duckdb-suite","title":"Pourquoi choisir DuckDB ? (suite)","text":"<p>\u2705 Langage SQL standard - Facile si vous connaissez SQL - Nombreuses fonctions analytiques</p> <p>\u2705 Lecture directe de fichiers - Requ\u00eates directes sur Parquet, CSV, etc. - Pas d'import n\u00e9cessaire</p> <p>\u2705 Extension spatiale - Fonctions GIS bas\u00e9es sur GEOS - Compatible avec PostGIS</p>"},{"location":"duckdb/presentation.html#extension-spatiale-de-duckdb","title":"Extension spatiale de DuckDB","text":"<p>Fonctionnalit\u00e9s avanc\u00e9es pour le SIG :</p> <ul> <li>Grande vari\u00e9t\u00e9 de fonctions spatiales (GEOS)</li> <li>Noms identiques \u00e0 PostGIS (migration facilit\u00e9e)</li> <li>Indexation spatiale</li> <li>Lecture/\u00e9criture de nombreux formats</li> <li>Support des drivers GDAL</li> </ul>"},{"location":"duckdb/presentation.html#installation-de-lextension-spatial","title":"Installation de l'extension spatial","text":"<pre><code>INSTALL spatial; \n</code></pre> <p>A faire qu'une seule fois sur le poste</p>"},{"location":"duckdb/presentation.html#chargement-de-lextension-spatial","title":"Chargement de l'extension spatial","text":"<pre><code>LOAD spatial; \n</code></pre> <p>Il s'agit de l'\u00e9quivalent du <code>CREATE EXTENSION postgis</code> sur une base dans PostgreSQL</p>"},{"location":"duckdb/presentation.html#olap-vs-oltp","title":"OLAP vs OLTP","text":"<p>DuckDB est optimis\u00e9 pour l'OLAP</p> <p>https://fr.wikipedia.org/wiki/Traitement_analytique_en_ligne</p> <p>En informatique, et plus particuli\u00e8rement dans le domaine des bases de donn\u00e9es, le traitement analytique en ligne (anglais online analytical processing, OLAP) est un type d'application informatique orient\u00e9 vers l'analyse sur-le-champ d'informations.</p> <ul> <li>OLAP: Traitement analytique en ligne (online analytical processing)</li> <li>OLTP: Traitement transactionnel en ligne (online transaction processing)</li> </ul>"},{"location":"duckdb/presentation.html#olap-vs-oltp_1","title":"OLAP vs OLTP","text":"OLAP (DuckDB) OLTP (PostgreSQL) Requ\u00eates analytiques complexes Transactions rapides Lecture de gros volumes Nombreuses \u00e9critures Peu de mises \u00e0 jour Mises \u00e0 jour fr\u00e9quentes Agr\u00e9gations et analyses Int\u00e9grit\u00e9 transactionnelle"},{"location":"duckdb/presentation.html#performance-architecture-colonnes","title":"Performance : Architecture colonnes","text":"<p>DuckDB excelle pour :</p> <ul> <li>Traitement de grands volumes de donn\u00e9es</li> <li>Donn\u00e9es de plusieurs gigaoctets</li> <li>Tables de plusieurs millions de lignes</li> <li>Requ\u00eates analytiques et agr\u00e9gations</li> </ul>"},{"location":"duckdb/presentation.html#benchmark-duckdb-vs-postgis","title":"Benchmark : DuckDB vs PostGIS","text":"<p>Donn\u00e9es : 13,1 millions de b\u00e2timents (GeoJSON 6,3 GB)</p> Op\u00e9ration DuckDB PostGIS Int\u00e9gration 4 min 5 min 30 s Calcul de buffer 38 s 1 min 54 s Ajout colonne + surface 2 s 2 min 58 s <p>\u26a0\ufe0f DuckDB ne remplace pas PostGIS Ils ont des cas d'usage diff\u00e9rents et compl\u00e9mentaires.</p>"},{"location":"duckdb/presentation.html#limitations-de-duckdb-12","title":"Limitations de DuckDB (1/2)","text":"<p>\u274c Pas de support des projections</p> <ul> <li>Pas de transformation de syst\u00e8mes de coordonn\u00e9es</li> <li>Donn\u00e9es doivent \u00eatre dans la m\u00eame projection</li> </ul> <p>\u274c Mono-utilisateur et local</p> <ul> <li>Usage local uniquement</li> <li>Pas de multi-utilisateurs simultan\u00e9s</li> </ul> <p>\u274c Verrouillage en lecture</p> <ul> <li>Base verrouill\u00e9e lors des lectures</li> </ul>"},{"location":"duckdb/presentation.html#limitations-de-duckdb-22","title":"Limitations de DuckDB (2/2)","text":"<p>\u274c Pas de gestion des droits</p> <ul> <li>Pas de syst\u00e8me de permissions</li> <li>Pas de gestion de r\u00f4les</li> </ul> <p>\u274c Projet jeune</p> <ul> <li>\u00c9volution rapide</li> <li>API peut changer</li> </ul> <p>\u274c OLAP uniquement</p> <ul> <li>Pas pour : \u00e9critures fr\u00e9quentes, transactions concurrentes, haute disponibilit\u00e9</li> </ul>"},{"location":"duckdb/presentation.html#utilisation-de-duckdb","title":"Utilisation de DuckDB","text":""},{"location":"duckdb/presentation.html#interface-en-ligne-de-commande-cli","title":"Interface en ligne de commande (CLI)","text":"<ul> <li>Linux, macOS, Windows</li> </ul>"},{"location":"duckdb/presentation.html#langages-de-programmation","title":"Langages de programmation","text":"<ul> <li>Python, R, Java, Node.js, Rust...</li> </ul>"},{"location":"duckdb/presentation.html#dans-qgis","title":"Dans QGIS","text":"<ul> <li>QDuckDB</li> </ul>"},{"location":"duckdb/presentation.html#utilisation-de-duckdb_1","title":"Utilisation de DuckDB","text":""},{"location":"duckdb/presentation.html#ide","title":"IDE","text":"<ul> <li>DBeaver</li> <li>DataGrip (freeware)</li> <li>Beekeeper Studio</li> </ul>"},{"location":"duckdb/presentation.html#web","title":"Web","text":"<p>Permet grace \u00e0 DuckDB WASM - DuckDB Shell - DuckUI - Avec la CLI via <code>duckdb -ui</code></p>"},{"location":"duckdb/presentation.html#03","title":"03","text":""},{"location":"duckdb/presentation.html#cas-dusage-en-sig","title":"Cas d'usage en SIG","text":""},{"location":"duckdb/presentation.html#plugin-qduckdb-pour-qgis","title":"Plugin QDuckDB pour QGIS","text":"<p>Int\u00e9gration de DuckDB dans QGIS</p> <ul> <li>D\u00e9veloppement financ\u00e9 par l'IFREMER</li> <li>Mode lecture seule actuellement</li> <li>Chargement de couches depuis DuckDB</li> <li>Disponible dans le gestionnaire d'extensions QGIS</li> </ul> <p>\ud83d\udcfa Vid\u00e9o de d\u00e9monstration</p>"},{"location":"duckdb/presentation.html#exemple-1-creer-une-table-geographique-depuis-un-csv","title":"Exemple 1 : Cr\u00e9er une table g\u00e9ographique depuis un CSV","text":"<p>Cr\u00e9er une couche spatiale depuis un CSV avec X,Y :</p> <pre><code>SELECT \n    *,\n    ST_Point(x, y) as geometry\nFROM read_csv('fichier.csv')\nWHERE x IS NOT NULL \n  AND y IS NOT NULL;\n</code></pre>"},{"location":"duckdb/presentation.html#exemple-2-conversion-shapefile-gpkg","title":"Exemple 2 : Conversion Shapefile \u2192 GPKG","text":"<p>Convertir un Shapefile en GeoPackage :</p> <pre><code>COPY (\n    SELECT * FROM ST_Read('input.shp')\n) TO 'output.gpkg' \nWITH (FORMAT GDAL, DRIVER 'GPKG');\n</code></pre>"},{"location":"duckdb/presentation.html#exemple-3-parquet-shapefile-avec-filtre","title":"Exemple 3 : Parquet \u2192 Shapefile avec filtre","text":"<p>Cr\u00e9er un Shapefile depuis Parquet avec filtre spatial :</p> <pre><code>COPY (\n    SELECT * \n    FROM read_parquet('data.parquet')\n    WHERE ST_Within(\n        geometry,\n        ST_MakeEnvelope(xmin, ymin, xmax, ymax)\n    )\n) TO 'filtered.shp' \nWITH (FORMAT GDAL, DRIVER 'ESRI Shapefile');\n</code></pre>"},{"location":"duckdb/presentation.html#generation-de-tuiles-vectorielles","title":"G\u00e9n\u00e9ration de tuiles vectorielles","text":"<p>Nouveaut\u00e9 depuis DuckDB 1.4</p> <p>\u2705 Avantages : - Performance \u00e9lev\u00e9e pour la g\u00e9n\u00e9ration de tuiles - Int\u00e9gration facile dans des pipelines - Alternative l\u00e9g\u00e8re aux solutions traditionnelles</p> <p>\ud83d\udcc2 Exemple par Max Gabrielsson</p>"},{"location":"duckdb/presentation.html#04","title":"04","text":""},{"location":"duckdb/presentation.html#complementarite-parquet-duckdb","title":"Compl\u00e9mentarit\u00e9 Parquet + DuckDB","text":""},{"location":"duckdb/presentation.html#le-duo-gagnant","title":"Le duo gagnant","text":"<p>Format ouvert (Parquet) - Stockage compact - Compression efficace - Portabilit\u00e9</p> <p>+</p> <p>Base de donn\u00e9es in-process (DuckDB) - Requ\u00eates SQL puissantes - Performance \u00e9lev\u00e9e - Facilit\u00e9 d'utilisation</p> <p>= Efficacit\u00e9 maximale</p>"},{"location":"duckdb/presentation.html#workflow-recommande","title":"Workflow recommand\u00e9","text":"<p>1. Stockage en Parquet - Compression et archivage - Partage et \u00e9change de donn\u00e9es</p> <p>2. Traitement avec DuckDB - Analyses et requ\u00eates complexes - Transformations et conversions</p> <p>3. Export vers format m\u00e9tier - GeoPackage pour QGIS - Shapefile pour compatibilit\u00e9 - GeoJSON pour le web - PostgreSQL/PostGIS pour production</p>"},{"location":"duckdb/presentation.html#cas-dusage-ideaux","title":"Cas d'usage id\u00e9aux \u2705","text":"<p>DuckDB + Parquet est parfait pour :</p> <ul> <li>Analyse exploratoire de donn\u00e9es (EDA)</li> <li>Prototypage rapide d'analyses spatiales</li> <li>Traitement batch de grandes donn\u00e9es</li> <li>Conversions de formats en masse</li> <li>G\u00e9n\u00e9ration de rapports analytiques</li> <li>Scripts ETL</li> <li>Travail en local sur donn\u00e9es volumineuses</li> <li>Recherche et d\u00e9veloppement</li> </ul>"},{"location":"duckdb/presentation.html#cas-dusage-a-eviter","title":"Cas d'usage \u00e0 \u00e9viter \u274c","text":"<p>Ne PAS utiliser pour :</p> <ul> <li>Applications web avec acc\u00e8s concurrent</li> <li>Syst\u00e8mes n\u00e9cessitant haute disponibilit\u00e9</li> <li>Applications transactionnelles (CRUD intensif)</li> <li>Cas n\u00e9cessitant gestion fine des droits utilisateurs</li> </ul>"},{"location":"duckdb/presentation.html#05","title":"05","text":""},{"location":"duckdb/presentation.html#conclusion","title":"Conclusion","text":""},{"location":"duckdb/presentation.html#points-cles-a-retenir","title":"Points cl\u00e9s \u00e0 retenir","text":"<ol> <li>Parquet : format de stockage efficace pour grandes donn\u00e9es</li> <li>DuckDB : SGBD performant pour l'analyse volumineuse</li> <li>Extension spatiale : capacit\u00e9s GIS avanc\u00e9es</li> <li>Parquet + DuckDB : duo id\u00e9al pour l'analyse g\u00e9ospatiale</li> <li>Compl\u00e9mentarit\u00e9 : ne remplace pas PostgreSQL/PostGIS </li> </ol>"},{"location":"duckdb/presentation.html#perspectives","title":"Perspectives","text":"<p>DuckDB est un projet jeune et dynamique</p> <ul> <li>\u00c9volution rapide</li> <li>\u00c9cosyst\u00e8me grandissant</li> <li>Nouvelles fonctionnalit\u00e9s r\u00e9guli\u00e8res</li> <li>Int\u00e9grations multiples</li> </ul> <p>\u2192 Un outil \u00e0 surveiller de pr\u00e8s dans le domaine g\u00e9ospatial</p>"},{"location":"duckdb/presentation.html#site-documentation-officielle","title":"Site &amp; Documentation officielle","text":"Ressource Lien \ud83c\udfe0 Site officiel duckdb.org \ud83d\udcd6 Documentation duckdb.org/docs \ud83d\uddfa\ufe0f Extension spatiale docs/extensions/spatial \ud83d\udcbb GitHub duckdb/duckdb"},{"location":"duckdb/presentation.html#outils-plugins","title":"Outils &amp; Plugins","text":"<ul> <li> <p>Awesome DuckDB \u2014 Une liste s\u00e9lectionn\u00e9e de biblioth\u00e8ques, d'outils et de ressources DuckDB   \u2192 github.com/davidgasquez/awesome-duckdb</p> </li> <li> <p>Plugin QGIS QDuckDB \u2014 Int\u00e9gration native de DuckDB dans QGIS   \u2192 plugins.qgis.org/plugins/qduckdb</p> </li> <li> <p>GeoParquet.io \u2014 Outils de transformation rapides pour les fichiers GeoParquet utilisant PyArrow et DuckDB   \u2192 geoparquet.io</p> </li> </ul>"},{"location":"duckdb/presentation.html#articles-tutoriels","title":"\ud83d\udcda Articles &amp; Tutoriels","text":""},{"location":"duckdb/presentation.html#geotribu","title":"G\u00e9otribu","text":"<ul> <li>DuckDB et donn\u00e9es spatiales   \u2192 geotribu.fr \u2014 DuckDB donn\u00e9es spatiales</li> </ul>"},{"location":"duckdb/presentation.html#icem7-serie-duckdb","title":"icem7 \u2014 S\u00e9rie DuckDB","text":"<ul> <li>Parquet devrait remplacer le format CSV   \u2192 icem7.fr/cartographie/parquet-devrait-remplacer-le-format-csv</li> </ul> <ul> <li>3 explorations bluffantes avec DuckDB (s\u00e9rie en 3 parties)</li> </ul> \u00c9pisode Th\u00e8me Lien 1/3 Interroger des fichiers distants lien 2/3 Butiner des API JSON lien 3/3 Croiser les requ\u00eates spatiales lien <ul> <li>Comment bien pr\u00e9parer son Parquet   \u2192 icem7.fr/outils/comment-bien-preparer-son-parquet</li> </ul>"}]}